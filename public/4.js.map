{"version":3,"sources":["webpack:///./resources/js/pages/admin-ctrl.ts"],"names":["d","cart","items","loaders","wish","count","total","cartLoader","wishLoader","q","userId","scrollTop","orderId","cform","title","error","saving","editingCat","action","editingSub","actionSub","prev","editingTag","actionTag","prevArr","openItemsModal","data","this","JSON","parse","modal","document","getElementById","Modal","show","updateRole","id","role","enc_id","spinner","btn","parentElement","classList","contains","remove","add","patch","then","res","updated","success","completeOrder","icon","done","editCat","val","querySelector","value","editSub","catSlug","inp","select","previewImg","ev","target","files","reader","FileReader","onload","e","result","readAsDataURL","previewImgArr","f","push","editTag","beforeMount","attachToGlobal","AdminCtrl"],"mappings":"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","file":"4.js","sourcesContent":["import { Component, Mixins } from \"vue-property-decorator\";\r\nimport Super from \"./super\";\r\nimport CartInterface from \"../interfaces/cart\";\r\nimport CartItemInterface from \"../interfaces/cart-item\";\r\nimport ProductMixin from \"../mixins/product-mixin\";\r\nimport ProductInterface from \"../interfaces/product\";\r\nimport { EMPTY_PRODUCT } from \"../mixins/product-mixin\";\r\nimport Axios from \"axios\";\r\n\r\nexport interface AdminCtrlData {\r\n    cart: CartInterface;\r\n    cartLoader: boolean;\r\n    wishLoader: boolean;\r\n    q: string;\r\n    userId: number;\r\n    scrollTop: number;\r\n    items: CartItemInterface[];\r\n    orderId: string;\r\n    cform: {\r\n        title: string;\r\n        error: string[];\r\n        saving: boolean;\r\n    };\r\n    editingCat: boolean;\r\n    action: string;\r\n    editingSub: boolean;\r\n    actionSub: string;\r\n    prev: string;\r\n    editingTag: boolean;\r\n    actionTag: string;\r\n    prevArr: string[];\r\n}\r\n\r\n@Component\r\nexport default class AdminCtrl extends Super {\r\n    public d: AdminCtrlData = {\r\n        cart: {\r\n            items: [],\r\n            // @ts-ignore\r\n            loaders: [1, 2, 3, 4],\r\n            wish: [],\r\n            count: 0,\r\n            total: 0\r\n        },\r\n        cartLoader: true,\r\n        wishLoader: true,\r\n        q: \"\",\r\n        userId: 0,\r\n        scrollTop: 0,\r\n        items: [],\r\n        orderId: \"\",\r\n        cform: {\r\n            title: \"\",\r\n            error: [],\r\n            saving: false\r\n        },\r\n        editingCat: false,\r\n        action: \"\",\r\n        editingSub: false,\r\n        actionSub: \"\",\r\n        prev: \"\",\r\n        editingTag: false,\r\n        actionTag: \"\",\r\n        prevArr: []\r\n    };\r\n\r\n    public openItemsModal(data: string, orderId: string) {\r\n        this.d.items = [...JSON.parse(data || \"[]\")];\r\n        // console.log(JSON.parse(data || \"[]\"));\r\n        this.d.orderId = orderId;\r\n        const modal = document.getElementById(\"items-modal\") as HTMLDivElement;\r\n        if (modal) {\r\n            // @ts-ignore\r\n            new Modal(modal).show();\r\n        }\r\n    }\r\n\r\n    public updateRole(id: string, role: string, enc_id: string) {\r\n        const spinner = document.getElementById(id) as HTMLDivElement;\r\n        const btn = spinner.parentElement as HTMLElement;\r\n        if (!spinner.classList.contains(\"d-none\")) {\r\n            return;\r\n        }\r\n        spinner.classList.remove(\"d-none\");\r\n        btn.classList.add(\"disabled\");\r\n\r\n        Axios.patch(`/users/${enc_id}/role`, { role }).then(res => {\r\n            if (!res || !res.data || !res.data.updated) {\r\n                this.error();\r\n                spinner.classList.add(\"d-none\");\r\n                btn.classList.remove(\"disabled\");\r\n                return;\r\n            }\r\n\r\n            spinner.classList.add(\"d-none\");\r\n            btn.classList.remove(\"disabled\");\r\n            this.success();\r\n        });\r\n    }\r\n\r\n    public completeOrder(id: string) {\r\n        const spinner = document.getElementById(\r\n            `spinord${id}`\r\n        ) as HTMLDivElement;\r\n        const btn = spinner.parentElement as HTMLElement;\r\n        const icon = document.getElementById(`icon${id}`) as HTMLSpanElement;\r\n        if (!spinner.classList.contains(\"d-none\")) {\r\n            return;\r\n        }\r\n        spinner.classList.remove(\"d-none\");\r\n        btn.classList.add(\"disabled\");\r\n\r\n        const done = { done: true };\r\n\r\n        Axios.patch(`/orders/${id}/complete`, done).then(res => {\r\n            if (!res || !res.data || !res.data.updated) {\r\n                this.error();\r\n                spinner.classList.add(\"d-none\");\r\n                btn.classList.remove(\"disabled\");\r\n                return;\r\n            }\r\n\r\n            spinner.classList.add(\"d-none\");\r\n            btn.classList.remove(\"disabled\");\r\n            btn.classList.add(\"d-none\");\r\n            // console.log(btn);\r\n            icon.classList.add(\"fa-check\", \"text-success\");\r\n            this.success();\r\n        });\r\n    }\r\n\r\n    // public saveCat(sub: boolean = false) {\r\n    //     if (this.d.cform.saving) {\r\n    //         // return;\r\n    //     }\r\n    //     this.d.cform.saving = true;\r\n    //     const title = this.d.cform.title;\r\n    //     Axios.post(\"/categories\", {\r\n    //         sub,\r\n    //         title\r\n    //     }).then(res => {\r\n    //         if (res && res.status === 422) {\r\n    //             this.error();\r\n    //             this.d.cform.error = res.data.errors;\r\n    //             this.d.cform.saving = false;\r\n    //             return;\r\n    //         }\r\n\r\n    //         if (!res || !res.data) {\r\n    //             this.error();\r\n    //             this.d.cform.saving = false;\r\n    //             return;\r\n    //         }\r\n\r\n    //         this.d.cform.saving = false;\r\n    //         this.success();\r\n    //         this.d.cform.title = \"\";\r\n    //         location.reload();\r\n    //     });\r\n    // }\r\n\r\n    public editCat(action: string, val: string) {\r\n        this.d.editingCat = true;\r\n        this.d.action = action;\r\n        const inp = document.querySelector(\"#ctitleInp\") as HTMLInputElement;\r\n        inp.value = val;\r\n    }\r\n\r\n    public editSub(action: string, val: string, catSlug: string) {\r\n        this.d.editingSub = true;\r\n        this.d.actionSub = action;\r\n        const inp = document.querySelector(\"#subtitleInp\") as HTMLInputElement;\r\n        const select = document.querySelector(\r\n            \"#selectCat\"\r\n        ) as HTMLSelectElement;\r\n        inp.value = val;\r\n        select.value = catSlug;\r\n    }\r\n\r\n    public previewImg(ev) {\r\n        const inp: HTMLInputElement = ev.target;\r\n        this.d.prev = \"\";\r\n        if (!inp.files) {\r\n            this.d.prev = \"\";\r\n            return;\r\n        }\r\n\r\n        if (inp.files[0]) {\r\n            const reader = new FileReader();\r\n\r\n            reader.onload = e => {\r\n                this.d.prev = (e.target as any).result;\r\n            };\r\n            reader.readAsDataURL(inp.files[0]);\r\n        }\r\n    }\r\n\r\n    public previewImgArr(ev) {\r\n        const inp: HTMLInputElement = ev.target;\r\n        this.d.prevArr = [];\r\n        if (!inp.files) {\r\n            this.d.prevArr = [];\r\n            return;\r\n        }\r\n\r\n        for (const f in inp.files) {\r\n            if (typeof inp.files[f] === 'object') {\r\n                // console.log(typeof f, typeof inp.files[f]);\r\n                const reader = new FileReader();\r\n\r\n                reader.onload = e => {\r\n                    this.d.prevArr.push((e.target as any).result);\r\n                };\r\n                reader.readAsDataURL(inp.files[f]);\r\n            }\r\n        }\r\n    }\r\n\r\n    public editTag(action: string, val: string) {\r\n        this.d.editingTag = true;\r\n        this.d.actionTag = action;\r\n        const inp = document.querySelector(\"#titleInp\") as HTMLInputElement;\r\n        inp.value = val;\r\n    }\r\n\r\n    beforeMount() {\r\n        this.attachToGlobal(this, [\r\n            \"openItemsModal\",\r\n            \"updateRole\",\r\n            \"completeOrder\",\r\n            // \"saveCat\",\r\n            \"editCat\",\r\n            \"editSub\",\r\n            \"previewImg\",\r\n            \"editTag\",\r\n            \"previewImgArr\"\r\n        ]);\r\n    }\r\n}\r\n"],"sourceRoot":""}