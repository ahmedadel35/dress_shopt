{"version":3,"sources":["webpack:///./resources/js/pages/product-show.ts"],"names":["d","cart","items","wish","count","total","cartLoader","wishLoader","q","product","id","user_id","category_slug","title","slug","price","qty","cartQty","save","info","sizes","colors","images","rates","rate_avg","img_path","saved_price","totalInt","created_at","updated_at","deleted_at","item","size","color","wishId","wishing","pItem","addingToCart","inCart","inWish","loadingRates","revData","userRev","userId","index","rate","message","alreadyReved","savingRev","nextRevUrl","userCanUpdate","feat","loading","data","nextUrl","remain","mp","related","emptyRates","revDataLoader","scrollTop","ratesRemain","loadProductData","get","this","params","avg","pi","then","res","prod","map","x","Math","round","random","src","loadRates","error","addToCart","productInx","addToCartNative","r","updated","finally","addToWish","itemInx","addToWishList","pushToCartList","path","append","pid","fillRevDataLoader","concat","length","can_update","setUserRev","next_page_url","to","addRev","method","product_id","indx","findIndex","unshift","parseInt","success","getLang","loadMoreRevs","deleteRate","inx","deleteBtn","$root","$refs","classList","contains","remove","delete","status","add","splice","loadFeaturedProds","loadFeaturedProdsNative","openModal","openModalNative","loadRelatedProds","console","log","Number","Array","fill","forEach","push","window","beforeMount","attachToGlobal","mounted","$on","checkIfProductExistsInCartOrWish","ProductShow"],"mappings":"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","file":"9.js","sourcesContent":["import { Component, Mixins } from \"vue-property-decorator\";\r\nimport Super from \"./super\";\r\nimport ProductList from \"./product-list\";\r\nimport ProductInterface from \"../interfaces/product\";\r\nimport CartInterface from \"../interfaces/cart\";\r\nimport Axios, { AxiosResponse } from \"axios\";\r\nimport ProductMixin, { EMPTY_PRODUCT } from \"../mixins/product-mixin\";\r\nimport RateInterface from \"../interfaces/rate\";\r\nimport ProductShowMixin from \"../mixins/product-show-mixin\";\r\n\r\nexport interface UserRev {\r\n    userId: number;\r\n    id: number;\r\n    index: number;\r\n    rate: number;\r\n    message: string;\r\n    alreadyReved: boolean;\r\n}\r\n\r\nexport interface Item {\r\n    size: number;\r\n    color: number;\r\n    qty: number;\r\n    wishId: number;\r\n    wishing: boolean;\r\n}\r\n\r\nexport interface ProductFeatData {\r\n    loading: boolean;\r\n    data: ProductInterface[];\r\n    nextUrl: string;\r\n    remain: number;\r\n}\r\n\r\nexport interface ProductShowData {\r\n    cart: CartInterface;\r\n    cartLoader: boolean;\r\n    wishLoader: boolean;\r\n    q: string;\r\n    product: ProductInterface;\r\n    item: Item;\r\n    pItem: Item;\r\n    addingToCart: boolean;\r\n    inCart: boolean;\r\n    inWish: boolean;\r\n    loadingRates: boolean;\r\n    revData: RateInterface[];\r\n    userRev: UserRev;\r\n    savingRev: boolean;\r\n    nextRevUrl: string;\r\n    userCanUpdate: boolean;\r\n    feat: ProductFeatData;\r\n    mp: ProductInterface;\r\n    related: ProductFeatData;\r\n    emptyRates: boolean;\r\n    revDataLoader: number[];\r\n    userId: number;\r\n    scrollTop: number;\r\n}\r\n\r\n@Component\r\nexport default class ProductShow extends Mixins(\r\n    ProductMixin,\r\n    ProductShowMixin\r\n) {\r\n    public d: ProductShowData = {\r\n        cart: {\r\n            items: [],\r\n            wish: [],\r\n            count: 0,\r\n            total: 0\r\n        },\r\n        cartLoader: true,\r\n        wishLoader: true,\r\n        q: \"\",\r\n        product: {\r\n            id: 0,\r\n            user_id: 0,\r\n            category_slug: \"\",\r\n            title: \"\",\r\n            slug: \"\",\r\n            price: 0,\r\n            qty: 0,\r\n            cartQty: 0,\r\n            save: 0,\r\n            info: \"\",\r\n            sizes: [],\r\n            colors: [],\r\n            images: [],\r\n            rates: [],\r\n            rate_avg: 0,\r\n            img_path: \"\",\r\n            saved_price: 0,\r\n            total: 0,\r\n            totalInt: 0,\r\n            created_at: \"\",\r\n            updated_at: \"\",\r\n            deleted_at: \"\"\r\n        },\r\n        item: {\r\n            size: 0,\r\n            color: 0,\r\n            qty: 1,\r\n            wishId: -10,\r\n            wishing: true\r\n        },\r\n        pItem: {\r\n            size: 0,\r\n            color: 0,\r\n            qty: 1,\r\n            wishId: -10,\r\n            wishing: true\r\n        },\r\n        addingToCart: false,\r\n        inCart: false,\r\n        inWish: false,\r\n        loadingRates: false,\r\n        revData: [],\r\n        userRev: {\r\n            userId: 0,\r\n            id: 0,\r\n            index: 0,\r\n            rate: 0,\r\n            message: \"\",\r\n            alreadyReved: false\r\n        },\r\n        savingRev: false,\r\n        nextRevUrl: \"\",\r\n        userCanUpdate: false,\r\n        feat: {\r\n            loading: false,\r\n            data: [],\r\n            nextUrl: \"\",\r\n            remain: 8\r\n        },\r\n        mp: EMPTY_PRODUCT,\r\n        related: {\r\n            loading: false,\r\n            data: [],\r\n            nextUrl: \"\",\r\n            remain: 8\r\n        },\r\n        emptyRates: false,\r\n        revDataLoader: [],\r\n        userId: 0,\r\n        scrollTop: 0,\r\n    };\r\n    public ratesRemain: number = 7;\r\n\r\n    public loadProductData() {\r\n        Axios.get(`/product/${this.slug}`, {\r\n            params: { avg: \"\", pi: \"\" }\r\n        }).then(res => {\r\n            if (!res || !res.data) {\r\n                this.error();\r\n                return;\r\n            }\r\n\r\n            res.data.images = res.data.prod.images.map(x => {\r\n                return {\r\n                    id: \"aww\" + Math.round(Math.random() * 1889797),\r\n                    src: x\r\n                };\r\n            });\r\n\r\n            this.d.product = res.data.prod;\r\n            this.d.product.rate_avg = res.data.rate_avg;\r\n            // console.log(this.d.product);\r\n            this.loadRates();\r\n        });\r\n    }\r\n\r\n    public addToCart(item: string = \"pItem\", productInx: string = \"product\") {\r\n        if (this.d.cartLoader || this.d.addingToCart) {\r\n            return;\r\n        }\r\n\r\n        this.d.addingToCart = true;\r\n        // console.log(this.d[item], item);\r\n        const res = this.addToCartNative(\r\n            this.d[productInx],\r\n            this.d[item].qty,\r\n            this.d[item].size,\r\n            this.d[item].color\r\n        );\r\n        res.then((r: AxiosResponse) => {\r\n            if (r && (r.data.item || r.data.updated)) {\r\n                this.d.addingToCart = false;\r\n            }\r\n        }).finally(() => (this.d.addingToCart = false));\r\n    }\r\n\r\n    public addToWish(\r\n        itemInx: string = \"pItem\",\r\n        productInx: string = \"product\"\r\n    ) {\r\n        if (this.d.wishLoader) {\r\n            return;\r\n        }\r\n\r\n        this.addToWishList(this.d, productInx, itemInx).then(res => {\r\n            if (res && res.item) {\r\n                this.pushToCartList({ item: res.item });\r\n            }\r\n        });\r\n    }\r\n\r\n    public loadRates(\r\n        path: string = `/product/${this.pid}/rates`,\r\n        append: boolean = false\r\n    ) {\r\n        this.d.loadingRates = true;\r\n        this.fillRevDataLoader();\r\n        Axios.get(path).then(res => {\r\n            if (!res || !res.data) {\r\n                this.error();\r\n                return;\r\n            }\r\n\r\n            this.d.revDataLoader = [];\r\n\r\n            if (!append) {\r\n                if (!res.data.data.length) {\r\n                    this.d.emptyRates = true;\r\n                    this.d.loadingRates = false;\r\n                    return;\r\n                }\r\n\r\n                this.d.revData = [...res.data.data];\r\n                // check if user have abilty to delete any rates\r\n                res.data.data.map(x => {\r\n                    if (x.user_id !== this.userId) {\r\n                        this.d.userCanUpdate = x.can_update;\r\n                        return;\r\n                    }\r\n                });\r\n                // console.log(this.d.userCanUpdate);\r\n            } else {\r\n                this.d.revData = [...this.d.revData.concat(res.data.data)];\r\n                // console.log(this.d.revData);\r\n            }\r\n\r\n            this.setUserRev(res.data.data);\r\n            this.d.nextRevUrl = res.data?.next_page_url || \"\";\r\n            // @ts-ignore\r\n            const remain = (res.total - res.to) / 7;\r\n            this.ratesRemain = remain <= 7 ? remain : 7;\r\n            this.d.loadingRates = false;\r\n        });\r\n    }\r\n\r\n    public addRev() {\r\n        this.d.savingRev = true;\r\n        let method = \"post\",\r\n            path = `/rates`;\r\n\r\n        if (this.d.userRev.alreadyReved) {\r\n            method = \"patch\";\r\n            path = `/rates/${this.d.userRev.id}`;\r\n        }\r\n\r\n        const r = {\r\n            user_id: this.userId,\r\n            product_id: this.pid,\r\n            rate: this.d.userRev.rate,\r\n            message: this.d.userRev.message\r\n        };\r\n        if (!this.d.userRev.message.length) {\r\n            delete r.message;\r\n        }\r\n\r\n        Axios[method](path, r).then(res => {\r\n            if (\r\n                !res ||\r\n                !res.data ||\r\n                (method === \"post\" && !res.data.rate) ||\r\n                (method === \"patch\" && !res.data.updated)\r\n            ) {\r\n                this.d.savingRev = false;\r\n                this.error();\r\n                return;\r\n            }\r\n\r\n            if (!this.d.userRev.alreadyReved) {\r\n                this.d.revData.unshift(res.data);\r\n                this.d.userRev.id = parseInt(res.data.id);\r\n                this.d.userRev.userId = this.userId;\r\n            } else {\r\n                const indx = this.d.revData.findIndex(\r\n                    x => x.user_id === this.userId\r\n                );\r\n                this.d.revData[indx].rate = this.d.userRev.rate;\r\n                this.d.revData[indx].message = this.d.userRev.message;\r\n                this.d.revData[indx].updated = res.data.updated;\r\n            }\r\n\r\n            this.d.userRev.alreadyReved = true;\r\n\r\n            this.success(this.getLang(2), this.getLang(5));\r\n\r\n            this.d.savingRev = false;\r\n        });\r\n    }\r\n\r\n    public loadMoreRevs() {\r\n        this.loadRates(this.d.nextRevUrl, true);\r\n    }\r\n\r\n    public deleteRate(id: number, inx: number) {\r\n        const deleteBtn = this.$root.$refs[\r\n            \"deleteRefBtn\" + id\r\n        ][0] as HTMLDivElement;\r\n\r\n        if (deleteBtn && !deleteBtn.classList.contains(\"d-none\")) {\r\n            return;\r\n        }\r\n        deleteBtn.classList.remove(\"d-none\");\r\n\r\n        Axios.delete(\"/rates/\" + id).then(res => {\r\n            if (!res || res.status !== 204) {\r\n                deleteBtn.classList.add(\"d-none\");\r\n                this.error();\r\n                return;\r\n            }\r\n\r\n            // remove rev from revs array\r\n            this.d.revData.splice(inx, 1);\r\n            // remove user rev\r\n            this.d.userRev = {\r\n                userId: 0,\r\n                id: 0,\r\n                index: 0,\r\n                rate: 0,\r\n                message: \"\",\r\n                alreadyReved: false\r\n            };\r\n            this.success();\r\n        });\r\n    }\r\n\r\n    public loadFeaturedProds(\r\n        path: string = \"/collection/featured\",\r\n        append: boolean = false\r\n    ) {\r\n        this.loadFeaturedProdsNative(this.d, path, append);\r\n    }\r\n\r\n    public openModal(slug: string) {\r\n        // console.log(slug);\r\n        this.openModalNative(this.d, slug, \"productShowModal\", { avg: true });\r\n    }\r\n\r\n    public loadRelatedProds(\r\n        path: string = `/product/${this.slug}/related`,\r\n        append: boolean = false\r\n    ) {\r\n        if (this.d.related.loading || !path.length) {\r\n            return;\r\n        }\r\n\r\n        this.d.related.loading = true;\r\n        Axios.get(path).then(res => {\r\n            if (!res.data.data) {\r\n                this.error();\r\n                return;\r\n            }\r\n\r\n            res = res.data;\r\n\r\n            if (append) {\r\n                this.d.related.data = this.d.related.data.concat([...res.data]);\r\n                // setTimeout(_ => this.hideLoader(append), 5000);\r\n            } else {\r\n                this.d.related.data = [...res.data];\r\n            }\r\n            // @ts-ignore\r\n            this.d.related.nextUrl = res?.next_page_url || \"\";\r\n            // @ts-ignore\r\n            const remain = Math.round((res.total - res.to) / 8);\r\n            this.d.related.remain = remain <= 8 ? remain : 8;\r\n            this.d.related.loading = false;\r\n        });\r\n    }\r\n\r\n    private setUserRev(d: RateInterface[]) {\r\n        const userId = this.userId;\r\n        const indx = d.findIndex(x => x.user_id === userId);\r\n\r\n        if (indx > -1) {\r\n            const r = d[indx];\r\n            console.log(r);\r\n            this.d.userRev.index = indx;\r\n            this.d.userRev.userId = userId;\r\n            this.d.userRev.id = Number(r.id);\r\n            this.d.userRev.rate = r.rate;\r\n            this.d.userRev.message = (r.message as string) || \"\";\r\n            this.d.userRev.alreadyReved = true;\r\n            console.log(this.d.userRev);\r\n        }\r\n    }\r\n\r\n    private fillRevDataLoader() {\r\n        Array(this.ratesRemain)\r\n            .fill(1)\r\n            .forEach(x => this.d.revDataLoader.push(x));\r\n    }\r\n\r\n    get slug(): string {\r\n        return window[\"xjs\"].slug;\r\n    }\r\n\r\n    get userId(): number {\r\n        return parseInt(window[\"xjs\"].user_id);\r\n    }\r\n\r\n    get pid(): number {\r\n        return parseInt(window[\"xjs\"].pid);\r\n    }\r\n\r\n    beforeMount() {\r\n        this.attachToGlobal(this, [\r\n            \"addToCart\",\r\n            \"addToWish\",\r\n            \"loadMoreRevs\",\r\n            \"addRev\",\r\n            \"deleteRate\",\r\n            \"loadFeaturedProds\",\r\n            \"loadRelatedProds\",\r\n            \"openModal\"\r\n        ]);\r\n    }\r\n\r\n    mounted() {\r\n        this.loadProductData();\r\n        this.loadFeaturedProds();\r\n        this.loadRelatedProds();\r\n        this.fillRevDataLoader();\r\n\r\n        this.$on(\"cartDone\", () => {\r\n            // check if product exists in cart\r\n            this.checkIfProductExistsInCartOrWish(this.d, this.pid, \"pItem\");\r\n        });\r\n    }\r\n}\r\n"],"sourceRoot":""}