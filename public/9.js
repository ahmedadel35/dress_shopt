(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{TV7q:function(e,t,a){"use strict";a.r(t);var d=a("mrSG"),r=a("YKMj"),i=a("vDqi"),s=a.n(i),o=a("fn6U"),n=a("OWwn"),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.d={cart:{items:[],wish:[],count:0,total:0},cartLoader:!0,wishLoader:!0,q:"",product:{id:0,user_id:0,category_slug:"",title:"",slug:"",price:0,qty:0,cartQty:0,save:0,info:"",sizes:[],colors:[],images:[],rates:[],rate_avg:0,img_path:"",saved_price:0,total:0,totalInt:0,created_at:"",updated_at:"",deleted_at:""},item:{size:0,color:0,qty:1,wishId:-10,wishing:!0},pItem:{size:0,color:0,qty:1,wishId:-10,wishing:!0},addingToCart:!1,inCart:!1,inWish:!1,loadingRates:!1,revData:[],userRev:{userId:0,id:0,index:0,rate:0,message:"",alreadyReved:!1},savingRev:!1,nextRevUrl:"",userCanUpdate:!1,feat:{loading:!1,data:[],nextUrl:"",remain:8},mp:o.a,related:{loading:!1,data:[],nextUrl:"",remain:8},emptyRates:!1,revDataLoader:[],userId:0,scrollTop:0},t.ratesRemain=7,t}return Object(d.c)(t,e),t.prototype.loadProductData=function(){var e=this;s.a.get("/product/"+this.slug,{params:{avg:"",pi:""}}).then((function(t){t&&t.data?(t.data.images=t.data.prod.images.map((function(e){return{id:"aww"+Math.round(1889797*Math.random()),src:e}})),e.d.product=t.data.prod,e.d.product.rate_avg=t.data.rate_avg,e.loadRates()):e.error()}))},t.prototype.addToCart=function(e,t){var a=this;(void 0===e&&(e="pItem"),void 0===t&&(t="product"),this.d.cartLoader||this.d.addingToCart)||(this.d.addingToCart=!0,this.addToCartNative(this.d[t],this.d[e].qty,this.d[e].size,this.d[e].color).then((function(e){e&&(e.data.item||e.data.updated)&&(a.d.addingToCart=!1)})).finally((function(){return a.d.addingToCart=!1})))},t.prototype.addToWish=function(e,t){var a=this;void 0===e&&(e="pItem"),void 0===t&&(t="product"),this.d.wishLoader||this.addToWishList(this.d,t,e).then((function(e){e&&e.item&&a.pushToCartList({item:e.item})}))},t.prototype.loadRates=function(e,t){var a=this;void 0===e&&(e="/product/"+this.pid+"/rates"),void 0===t&&(t=!1),this.d.loadingRates=!0,this.fillRevDataLoader(),s.a.get(e).then((function(e){var r;if(e&&e.data){if(a.d.revDataLoader=[],t)a.d.revData=Object(d.f)(a.d.revData.concat(e.data.data));else{if(!e.data.data.length)return a.d.emptyRates=!0,void(a.d.loadingRates=!1);a.d.revData=Object(d.f)(e.data.data),e.data.data.map((function(e){e.user_id===a.userId||(a.d.userCanUpdate=e.can_update)}))}a.setUserRev(e.data.data),a.d.nextRevUrl=(null===(r=e.data)||void 0===r?void 0:r.next_page_url)||"";var i=(e.total-e.to)/7;a.ratesRemain=i<=7?i:7,a.d.loadingRates=!1}else a.error()}))},t.prototype.addRev=function(){var e=this;this.d.savingRev=!0;var t="post",a="/rates";this.d.userRev.alreadyReved&&(t="patch",a="/rates/"+this.d.userRev.id);var d={user_id:this.userId,product_id:this.pid,rate:this.d.userRev.rate,message:this.d.userRev.message};this.d.userRev.message.length||delete d.message,s.a[t](a,d).then((function(a){if(!a||!a.data||"post"===t&&!a.data.rate||"patch"===t&&!a.data.updated)return e.d.savingRev=!1,void e.error();if(e.d.userRev.alreadyReved){var d=e.d.revData.findIndex((function(t){return t.user_id===e.userId}));e.d.revData[d].rate=e.d.userRev.rate,e.d.revData[d].message=e.d.userRev.message,e.d.revData[d].updated=a.data.updated}else e.d.revData.unshift(a.data),e.d.userRev.id=parseInt(a.data.id),e.d.userRev.userId=e.userId;e.d.userRev.alreadyReved=!0,e.success(e.getLang(2),e.getLang(5)),e.d.savingRev=!1}))},t.prototype.loadMoreRevs=function(){this.loadRates(this.d.nextRevUrl,!0)},t.prototype.deleteRate=function(e,t){var a=this,d=this.$root.$refs["deleteRefBtn"+e][0];d&&!d.classList.contains("d-none")||(d.classList.remove("d-none"),s.a.delete("/rates/"+e).then((function(e){if(!e||204!==e.status)return d.classList.add("d-none"),void a.error();a.d.revData.splice(t,1),a.d.userRev={userId:0,id:0,index:0,rate:0,message:"",alreadyReved:!1},a.success()})))},t.prototype.loadFeaturedProds=function(e,t){void 0===e&&(e="/collection/featured"),void 0===t&&(t=!1),this.loadFeaturedProdsNative(this.d,e,t)},t.prototype.openModal=function(e){this.openModalNative(this.d,e,"productShowModal",{avg:!0})},t.prototype.loadRelatedProds=function(e,t){var a=this;void 0===e&&(e="/product/"+this.slug+"/related"),void 0===t&&(t=!1),!this.d.related.loading&&e.length&&(this.d.related.loading=!0,s.a.get(e).then((function(e){if(e.data.data){e=e.data,a.d.related.data=t?a.d.related.data.concat(Object(d.f)(e.data)):Object(d.f)(e.data),a.d.related.nextUrl=(null==e?void 0:e.next_page_url)||"";var r=Math.round((e.total-e.to)/8);a.d.related.remain=r<=8?r:8,a.d.related.loading=!1}else a.error()})))},t.prototype.setUserRev=function(e){var t=this.userId,a=e.findIndex((function(e){return e.user_id===t}));if(a>-1){var d=e[a];console.log(d),this.d.userRev.index=a,this.d.userRev.userId=t,this.d.userRev.id=Number(d.id),this.d.userRev.rate=d.rate,this.d.userRev.message=d.message||"",this.d.userRev.alreadyReved=!0,console.log(this.d.userRev)}},t.prototype.fillRevDataLoader=function(){var e=this;Array(this.ratesRemain).fill(1).forEach((function(t){return e.d.revDataLoader.push(t)}))},Object.defineProperty(t.prototype,"slug",{get:function(){return window.xjs.slug},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userId",{get:function(){return parseInt(window.xjs.user_id)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pid",{get:function(){return parseInt(window.xjs.pid)},enumerable:!1,configurable:!0}),t.prototype.beforeMount=function(){this.attachToGlobal(this,["addToCart","addToWish","loadMoreRevs","addRev","deleteRate","loadFeaturedProds","loadRelatedProds","openModal"])},t.prototype.mounted=function(){var e=this;this.loadProductData(),this.loadFeaturedProds(),this.loadRelatedProds(),this.fillRevDataLoader(),this.$on("cartDone",(function(){e.checkIfProductExistsInCartOrWish(e.d,e.pid,"pItem")}))},t=Object(d.b)([r.a],t)}(Object(r.b)(o.b,n.a));t.default=u}}]);
//# sourceMappingURL=9.js.map