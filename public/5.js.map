{"version":3,"sources":["webpack:///./resources/js/pages/admin-product-list.ts"],"names":["EmptyForm","id","user_id","title","slug","price","priceInt","save","qty","sizes","colors","category_slug","images","info","saved_price","img_path","hasErrors","tags","color","size","tag","more","d","cart","items","loaders","wish","count","total","cartLoader","wishLoader","q","userId","scrollTop","mp","item","wishId","wishing","deleting","form","errors","cats","prev","saving","attr","keys","vals","editing","activeSlug","openModal","this","openModalNative","avg","pi","delete","spinner","document","getElementById","btn","parentElement","product","classList","contains","remove","add","then","res","status","error","success","create","modal","Object","assign","Modal","show","previewImg","ev","inp","target","files","f","reader","FileReader","onload","e","push","result","readAsDataURL","saveProd","FormData","append","c","text","s","t","i","length","path","post","headers","data","location","reload","filteredItems","filter","toLowerCase","indexOf","starProd","stared","param","feat","patch","updated","edit","get","params","prod","map","forEach","x","k","beforeMount","attachToGlobal","mounted","JSON","parse","window","AdminProductList"],"mappings":"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","file":"5.js","sourcesContent":["import { Component, Mixins } from \"vue-property-decorator\";\r\nimport Super from \"./super\";\r\nimport CartInterface from \"../interfaces/cart\";\r\nimport ProductInterface from \"../interfaces/product\";\r\nimport ProductMixin from \"../mixins/product-mixin\";\r\nimport { EMPTY_PRODUCT } from \"../mixins/product-mixin\";\r\nimport Axios from \"axios\";\r\nimport CategoryInterface from \"../interfaces/category\";\r\nimport TagInterface from \"../interfaces/tag\";\r\n\r\nexport const EmptyForm: ProductInterface = {\r\n    id: 0,\r\n    user_id: 0,\r\n    title: \"\",\r\n    slug: \"\",\r\n    price: 0,\r\n    priceInt: 0,\r\n    save: 0,\r\n    qty: 0,\r\n    // @ts-ignore\r\n    sizes: [],\r\n    // @ts-ignore\r\n    colors: [],\r\n    category_slug: \"\",\r\n    images: [],\r\n    info: \"\",\r\n    saved_price: 0,\r\n    img_path: \"\",\r\n    // @ts-ignore\r\n    hasErrors: false,\r\n    tags: [],\r\n    // @ts-ignore\r\n    color: \"\",\r\n    // @ts-ignore\r\n    size: \"\",\r\n    // @ts-ignore\r\n    tag: \"\",\r\n    // @ts-ignore\r\n    more: \"\"\r\n};\r\n\r\nexport interface AdminProductListData {\r\n    cart: CartInterface;\r\n    cartLoader: boolean;\r\n    wishLoader: boolean;\r\n    q: string;\r\n    userId: number;\r\n    scrollTop: number;\r\n    mp: ProductInterface;\r\n    item: {\r\n        size: number;\r\n        color: number;\r\n        qty: number;\r\n        wishId: number;\r\n        wishing: boolean;\r\n    };\r\n    deleting: boolean;\r\n    form: ProductInterface;\r\n    errors: ProductInterface;\r\n    cats: CategoryInterface[];\r\n    prev: string[];\r\n    saving: boolean;\r\n    tags: {\r\n        text: string;\r\n        slug: string;\r\n    }[];\r\n    // filteredItems: {\r\n    //     text: string,\r\n    //     slug: string\r\n    // }[];\r\n    attr: { keys: string[]; vals: string[] };\r\n    editing: boolean;\r\n    activeSlug: string;\r\n}\r\n\r\n@Component\r\nexport default class AdminProductList extends Mixins(ProductMixin) {\r\n    public d: AdminProductListData = {\r\n        cart: {\r\n            items: [],\r\n            // @ts-ignore\r\n            loaders: [1, 2, 3, 4],\r\n            wish: [],\r\n            count: 0,\r\n            total: 0\r\n        },\r\n        cartLoader: true,\r\n        wishLoader: true,\r\n        q: \"\",\r\n        userId: 0,\r\n        scrollTop: 0,\r\n        mp: EMPTY_PRODUCT,\r\n        item: {\r\n            size: 0,\r\n            color: 0,\r\n            qty: 1,\r\n            wishId: 0,\r\n            wishing: false\r\n        },\r\n        deleting: false,\r\n        form: EmptyForm,\r\n        errors: EmptyForm,\r\n        cats: [],\r\n        prev: [],\r\n        saving: false,\r\n        tags: [],\r\n        // filteredItems: [],\r\n        attr: { keys: [\"\"], vals: [\"\"] },\r\n        editing: false,\r\n        activeSlug: \"\"\r\n    };\r\n\r\n    public openModal(slug: string) {\r\n        this.openModalNative(this.d, slug, \"adminProductModal\", {\r\n            avg: true,\r\n            pi: true\r\n        });\r\n    }\r\n\r\n    public delete(slug: string, id: number) {\r\n        const spinner = document.getElementById(\r\n            `spinnerDel${id}`\r\n        ) as HTMLDivElement;\r\n        const btn = spinner.parentElement as HTMLButtonElement;\r\n        const product = document.getElementById(`prod${id}`) as HTMLDivElement;\r\n        if (btn.classList.contains(\"disabled\")) {\r\n            return;\r\n        }\r\n        spinner.classList.remove(\"d-none\");\r\n        btn.classList.add(\"disabled\");\r\n\r\n        Axios.delete(`/product/${slug}`).then(res => {\r\n            if (!res || res.status !== 204) {\r\n                this.error();\r\n                spinner.classList.add(\"d-none\");\r\n                btn.classList.remove(\"disabled\");\r\n            }\r\n\r\n            spinner.classList.add(\"d-none\");\r\n            btn.classList.remove(\"disabled\");\r\n            product.classList.add(\"d-none\");\r\n            this.success();\r\n        });\r\n    }\r\n\r\n    public create(id: string) {\r\n        this.d.editing = false;\r\n        const modal = document.getElementById(id) as HTMLDivElement;\r\n        this.d.form = Object.assign({}, EmptyForm);\r\n        this.d.errors = Object.assign({}, EmptyForm);\r\n        this.d.attr.keys = [''];\r\n        this.d.attr.vals = [''];\r\n        this.d.prev = [];\r\n        if (modal) {\r\n            // @ts-ignore\r\n            new Modal(modal).show();\r\n        }\r\n    }\r\n\r\n    public previewImg(ev) {\r\n        const inp: HTMLInputElement = ev.target;\r\n        this.d.prev = [];\r\n        if (!inp.files) {\r\n            this.d.prev = [];\r\n            return;\r\n        }\r\n        this.d.form.images = inp;\r\n\r\n        for (const f in inp.files) {\r\n            if (typeof inp.files[f] === 'object') {\r\n                // console.log(typeof f, typeof inp.files[f]);\r\n                const reader = new FileReader();\r\n\r\n                reader.onload = e => {\r\n                    this.d.prev.push((e.target as any).result);\r\n                };\r\n                reader.readAsDataURL(inp.files[f]);\r\n            }\r\n        }\r\n    }\r\n\r\n    public saveProd() {\r\n        if (this.d.saving) {\r\n            return;\r\n        }\r\n        this.d.saving = true;\r\n        const form = new FormData();\r\n        form.append(\"title\", this.d.form.title);\r\n        // console.log(form.get('title'));\r\n        form.append(\"price\", this.d.form.price as string);\r\n        form.append(\"save\", this.d.form.save as string);\r\n        form.append(\"info\", this.d.form.info);\r\n        form.append(\"category_slug\", this.d.form.category_slug);\r\n        // @ts-ignore\r\n        form.append(\"more\", this.d.form.more);\r\n        // @ts-ignore\r\n        form.append(\"qty\", this.d.form.qty);\r\n\r\n        for (const c of this.d.form.colors) {\r\n            // @ts-ignore\r\n            form.append(\"colors[]\", c.text);\r\n        }\r\n\r\n        for (const s of this.d.form.sizes) {\r\n            // @ts-ignore\r\n            form.append(\"sizes[]\", s.text);\r\n        }\r\n\r\n        for (const t of this.d.form.tags as TagInterface[]) {\r\n            // @ts-ignore\r\n            form.append(\"tags[]\", t.slug);\r\n        }\r\n\r\n        for (const f in this.d.form.images.files) {\r\n            form.append(\"images[]\", this.d.form.images.files[f]);\r\n        }\r\n\r\n        // append attrs\r\n        for (let i = 0; i < this.d.attr.keys.length; i++) {\r\n            form.append(\"keys[]\", this.d.attr.keys[i]);\r\n            form.append(\"vals[]\", this.d.attr.vals[i]);\r\n        }\r\n\r\n        const path = this.d.editing\r\n            ? `/product/${this.d.activeSlug}`\r\n            : \"/product\";\r\n        // console.log(path, method);\r\n\r\n        // console.log(form.get('title'));\r\n\r\n        Axios.post(path, form, {\r\n            headers: {\r\n                \"Content-Type\": \"multipart/form-data\"\r\n            }\r\n        }).then(res => {\r\n            if (res && res.status === 422) {\r\n                this.d.saving = false;\r\n                this.error();\r\n                this.d.errors = res.data.errors;\r\n                // @ts-ignore\r\n                this.d.form.hasErrors = true;\r\n                return;\r\n            }\r\n\r\n            if (!res || !res.data) {\r\n                this.error();\r\n                this.d.saving = false;\r\n                return;\r\n            }\r\n\r\n            this.d.saving = false;\r\n            this.success();\r\n            location.reload();\r\n        });\r\n    }\r\n\r\n    public filteredItems() {\r\n        return this.d.tags.filter(i => {\r\n            // @ts-ignore\r\n            return (\r\n                // @ts-ignore\r\n                i.text.toLowerCase().indexOf(this.d.form.tag.toLowerCase()) !==\r\n                -1\r\n            );\r\n        });\r\n    }\r\n\r\n    public starProd(id: number, slug: string) {\r\n        const spinner = document.getElementById(\r\n            `spinnerStar${id}`\r\n        ) as HTMLDivElement;\r\n        const btn = spinner.parentElement as HTMLButtonElement;\r\n        const stared = btn.classList.contains(\"btn-success\");\r\n        const param = stared ? {} : { feat: true };\r\n        if (btn.classList.contains(\"disabled\")) {\r\n            return;\r\n        }\r\n\r\n        spinner.classList.remove(\"d-none\");\r\n        btn.classList.add(\"disabled\");\r\n\r\n        Axios.patch(`/product/star/${slug}`, param).then(res => {\r\n            if (!res || !res.data || !res.data.updated) {\r\n                this.error();\r\n                spinner.classList.add(\"d-none\");\r\n                btn.classList.remove(\"disabled\");\r\n                return;\r\n            }\r\n\r\n            this.success();\r\n            spinner.classList.add(\"d-none\");\r\n            btn.classList.remove(\"disabled\");\r\n            if (stared) {\r\n                btn.classList.remove(\"btn-success\");\r\n                btn.classList.add(\"btn-warning\");\r\n            } else {\r\n                btn.classList.add(\"btn-success\");\r\n                btn.classList.remove(\"btn-warning\");\r\n            }\r\n        });\r\n    }\r\n\r\n    public async edit(id: string, slug: string) {\r\n        const spinner = document.getElementById(\r\n            `spinnerEdit${id}`\r\n        ) as HTMLDivElement;\r\n        const btn = spinner.parentElement as HTMLButtonElement;\r\n        this.d.form = Object.assign({}, EmptyForm);\r\n        this.d.errors = Object.assign({}, EmptyForm);\r\n\r\n        if (btn.classList.contains(\"disabled\")) {\r\n            return;\r\n        }\r\n\r\n        this.d.editing = true;\r\n\r\n        spinner.classList.remove(\"d-none\");\r\n        btn.classList.add(\"disabled\");\r\n\r\n        // get product data\r\n        const prod = await Axios.get(`/product/${slug}`, {\r\n            params: { pi: true }\r\n        });\r\n        if (!prod || !prod.data) {\r\n            this.error();\r\n            spinner.classList.add(\"d-none\");\r\n            btn.classList.remove(\"disabled\");\r\n            return;\r\n        }\r\n\r\n        const modal = document.getElementById(\r\n            \"createproduct\"\r\n        ) as HTMLDivElement;\r\n        // this.d.form = Object.assign({}, prod.data);\r\n        const d: ProductInterface = prod.data;\r\n        this.d.form.title = d.title;\r\n        this.d.form.id = d.id;\r\n        this.d.form.price = d.price;\r\n        this.d.form.save = d.save;\r\n        this.d.form.qty = d.qty;\r\n        // this.d.form.colors = d.colors;\r\n        d.colors.map(c => {\r\n            // @ts-ignore\r\n            this.d.form.colors.push({text: c});\r\n        });\r\n        d.sizes.map(s => {\r\n            // @ts-ignore\r\n            this.d.form.sizes.push({text: s});\r\n        });\r\n        this.d.form.info = d.info;\r\n        this.d.form.category_slug = d.category_slug;\r\n        this.d.form.images = d.images;\r\n\r\n        this.d.activeSlug = prod.data.slug;\r\n        this.d.prev = prod.data.images;\r\n        const tags = prod.data.tags;\r\n        this.d.form.tags = [];\r\n        tags.forEach(x => {\r\n            const i = { text: x.title, slug: x.slug };\r\n            // @ts-ignore\r\n            this.d.form.tags.push(i);\r\n        });\r\n        // @ts-ignore\r\n        this.d.form.hasErrors = false;\r\n        // @ts-ignore\r\n        this.d.form.color = \"\";\r\n        // @ts-ignore\r\n        this.d.form.size = \"\";\r\n        // @ts-ignore\r\n        this.d.form.tag = \"\";\r\n        // @ts-ignore\r\n        this.d.form.more = \"\";\r\n\r\n        if (prod.data.pi) {\r\n            this.d.attr.keys = [];\r\n            this.d.attr.vals = [];\r\n            for (const k in prod.data.pi.more) {\r\n                this.d.attr.keys.push(k);\r\n                this.d.attr.vals.push(prod.data.pi.more[k]);\r\n            }\r\n        }\r\n\r\n        this.d.errors = Object.assign({}, EmptyForm);\r\n        if (modal) {\r\n            // @ts-ignore\r\n            new Modal(modal).show();\r\n        }\r\n        spinner.classList.add(\"d-none\");\r\n        btn.classList.remove(\"disabled\");\r\n    }\r\n\r\n    beforeMount() {\r\n        this.attachToGlobal(this, [\r\n            \"openModal\",\r\n            \"delete\",\r\n            \"create\",\r\n            \"previewImg\",\r\n            \"saveProd\",\r\n            \"filteredItems\",\r\n            \"starProd\",\r\n            \"edit\"\r\n        ]);\r\n    }\r\n\r\n    mounted() {\r\n        this.d.cats = JSON.parse(window[\"xjs\"].cats || \"[]\");\r\n\r\n        // save tags\r\n        const tags = JSON.parse(window[\"xjs\"].tags || \"[]\") as TagInterface[];\r\n        tags.forEach(x => {\r\n            const i = { text: x.title, slug: x.slug };\r\n            // @ts-ignore\r\n            this.d.tags.push(i);\r\n        });\r\n        // console.log(this.d.tags);\r\n    }\r\n}\r\n"],"sourceRoot":""}